#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------
# This file contains a custom dock configuration that Gitpod will use for the underlying image for the Gitpod 
# borwser IDE.
# For useful context regarding custom Dockerfiles and images for GitPod see these links:
# https://www.gitpod.io/docs/config-docker
# https://www.gitpod.io/blog/docker-in-gitpod
#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------
FROM gitpod/workspace-full

#--------------------------------------------------------------------------------------------------------------
# INstall as root.
#--------------------------------------------------------------------------------------------------------------
USER root

# Install codeql ----------------------------------------------------------------------------------------------
RUN pwd \
    && mkdir /tmp \
    && cd /tmp \
    && wget https://github.com/github/codeql-cli-binaries/releases/download/v2.6.1/codeql-linux64.zip \
    && unzip codeql-linux64.zip \
	&& rm codeql-linux64.zip \
    && mv codeql /home/gitpod/ \
    && echo 'export PATH="\$HOME/codeql:\$PATH"' >>  /home/gitpod/.bashrc


#--------------------------------------------------------------------------------------------------------------
# Install as gitpod.
#--------------------------------------------------------------------------------------------------------------
USER gitpod


#--------------------------------------------------------------------------------------------------------------
# Return control ot root.
#--------------------------------------------------------------------------------------------------------------
USER root
